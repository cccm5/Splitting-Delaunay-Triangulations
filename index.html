<!DOCTYPE html>
<meta charset="utf-8">

<head>
</head>

<body>
  <div class="border">
    <div style="text-align: center">
      <h1 class="title">Splitting Delaunay Triangulations</h1>
    </div>
    <div class="flex-container">
      <div class="interface">
        <button type=button class="button1">Run</button>
        <button type=button class="button2">Reset</button>
        <div class="slidecontainer">
          <input type="range" min="1" max="100" value="50" class="slider" id="myRange">
        </div>
      </div>
      <div class="image">
        <svg width="960" height="500" class="boxed"></svg>
      </div>
    </div>
  </div>


<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="https://unpkg.com/delaunator@3.0.2/delaunator.js"></script>
<script>

var svg = d3.select("svg"),
    width = +svg.attr("width"),
    height = +svg.attr("height");
// const points = [[0, 0], [0, 100], [100, 0], [100, 100], [200, 200], [20, 20]]
const points = Array.from({length: 80}, ()=> [Math.floor(Math.random()*width), Math.floor(Math.random()*height)])
const delaunay = Delaunator.from(points);
const triangles = delaunay.hull
console.log(triangles);
// for (let i = 1; i < triangles.length; i ++) {
//   svg.append("line")
//   .attr("x1", points[triangles[i]][0])
//   .attr("y1", points[triangles[i]][1])
//   .attr("x2", points[triangles[i-1]][0])
//   .attr("y2", points[triangles[i-1]][1])
//   .attr("stroke-width", 2)
//   .attr("stroke", "lightgrey");
//   console.log(points[triangles[i]])
// }

forEachTriangleEdge(points, delaunay, (_,b,c) => drawEdge(b,c,svg))
for(let i = 0; i < points.length; i++){
  svg.append("circle")
  .attr('cx', points[i][0])
  .attr('cy', points[i][1])
  .attr('r', 3)
}

function drawEdge(p1, p2, svg) {
  svg.append("line")
  .attr("x1", p1[0])
  .attr("y1", p1[1])
  .attr("x2", p2[0])
  .attr("y2", p2[1])
  .attr("stroke-width", 2)
  .attr("stroke", "lightgrey");
}



function edgesOfTriangle(t) { return [3 * t, 3 * t + 1, 3 * t + 2]; }
function triangleOfEdge(e)  { return Math.floor(e / 3); }
function nextHalfedge(e) { return (e % 3 === 2) ? e - 2 : e + 1; }
function prevHalfedge(e) { return (e % 3 === 0) ? e + 2 : e - 1; }

function forEachTriangleEdge(points, delaunay, callback) {
    for (let e = 0; e < delaunay.triangles.length; e++) {
        if (e > delaunay.halfedges[e]) {
            const p = points[delaunay.triangles[e]];
            const q = points[delaunay.triangles[nextHalfedge(e)]];
            callback(e, p, q);
        }
    }
}

</script>

<style>



.triangles {
  fill: none;
}

.links {
  stroke: #000;
}

.sites {
  fill: #000;
  stroke: #fff;
}

.triangles .primary {
  fill: #f00;
}

.links .primary {
  stroke: #fff;
}

.sites :first-child {
  fill: #fff;
}

.title {
  font-family: Arial;
}

.boxed {
  text-align: right;
  padding: 20px;
  border: 2px solid lightgrey;
  border-left: 0px;
  border-right: 0px;
  border-bottom: 0px;
  float: right;
  height: 500px;
  position: relative;
}


.image {
  background-color: white;
}

.interface {
  width: 100%;
    border: 2px solid lightgrey;
    padding: 30px;
    margin: 0px;
    text-align: center;
    border-left: 0px;
    border-bottom: 0px;
  position: relative;
}

.interface:after {
  content: '';
  display: block;
  position: absolute;
  height: 15px;
  width: 30px;
  top: 0px;
  right: -5px;
  border: 5px solid white;
}


.flex-container {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
}


.button1 {
  background-color: #f44336; 
  border: none;
  color: white;
  padding: 15px 32px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
}

.button2 {
  background-color: #008CBA;
  border: none;
  color: white;
  padding: 15px 32px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
}

.slidecontainer {
  width: 100%; 
  position: relative;
  top: 50%;
}

.slider {
  -webkit-appearance: none;  
  appearance: none;
  width: 100%; 
  height: 15px; 
  background: #d3d3d3; 
  outline: none;
  opacity: 0.7; 
  -webkit-transition: .2s; 
  transition: opacity .2s;
  
  top: 40%;
  transform: rotate(270deg);
}


.slider:hover {
  opacity: 1; 
}


.slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 20px;
  height: 20px;
  background: black;
  cursor: pointer;
}

.slider::-moz-range-thumb {
  width: 20px;
  height: 20px;
  background: black;
  cursor: pointer;
}

</style>

</body>
